{
  "name": "schedulebudapp",
  "description": "ScheduleBud - Student task management app with Canvas integration and AI assistance",
  "spec": {
    "kind": "Workflow",
    "spec": {
      "type": "sequential",
      "context": {
        "stack": "nodejs",
        "language": "javascript"
      },
      "steps": [
        {
          "name": "build",
          "spec": {
            "kind": "Build",
            "spec": {
              "source": {
                "type": "git"
              },
              "docker": {
                "buildEngine": "kaniko",
                "dockerfile": {
                  "inline": "FROM node:18-alpine AS build\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nRUN npm run build\n\nFROM nginx:alpine\nCOPY --from=build /app/build /usr/share/nginx/html\nCOPY nginx.conf /etc/nginx/nginx.conf\nEXPOSE 80\nCMD [\"nginx\", \"-g\", \"daemon off;\"]"
                }
              }
            }
          }
        },
        {
          "name": "deploy",
          "spec": {
            "kind": "DeploymentService",
            "spec": {
              "deployment": {
                "instances": 2,
                "docker": {
                  "configType": "default"
                }
              },
              "ports": [
                {
                  "name": "http",
                  "internalPort": 80,
                  "public": true,
                  "protocol": "HTTP",
                  "domains": ["schedulebudapp.com", "www.schedulebudapp.com"]
                }
              ],
              "env": [
                {
                  "name": "NODE_ENV",
                  "value": "production"
                },
                {
                  "name": "REACT_APP_BUILD_MODE",
                  "value": "saas"
                }
              ],
              "secretEnv": [
                {
                  "name": "REACT_APP_SUPABASE_URL",
                  "secretName": "supabase-url"
                },
                {
                  "name": "REACT_APP_SUPABASE_ANON_KEY", 
                  "secretName": "supabase-anon-key"
                },
                {
                  "name": "REACT_APP_STRIPE_PUBLISHABLE_KEY",
                  "secretName": "stripe-publishable-key"
                }
              ]
            }
          }
        }
      ]
    }
  }
}